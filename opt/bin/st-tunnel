#!/usr/bin/env bash
set -eo pipefail

if [ $# -ne 1 ]; then
  echo "Usage: st-tunnel MACHINE-NAME"
  exit 1
fi

case $1 in
  burr)
    (sleep 1 && open "http://localhost:9999")&
    ssh -L 9999:localhost:8384 burr
    ;;
  goliath)
    (sleep 1 && open "http://localhost:9998")&
    ssh -L 9998:localhost:8384 goliath
    ;;
  curie)
    (sleep 1 && open "http://localhost:9997")&
    ssh -L 9997:localhost:8384 curie
    ;;
  opportunity)
    (sleep 1 && open "http://localhost:9996")&
    ssh -L 9996:localhost:8384 opportunity
    ;;
  pi400)
    (sleep 1 && open "http://localhost:9994")&
    ssh -L 9994:localhost:8384 pi400
    ;;
  *)
    echo "unknown machine name: $1"
    exit 1
    ;;
esac
